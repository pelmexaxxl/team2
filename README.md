# ü§ñ Telegram Pulse Survey Bot

–ë–æ—Ç –¥–ª—è Telegram, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø—É–ª—å—Å-–æ–ø—Ä–æ—Å—ã. –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ `aiogram` 3 –∏ PostgreSQL.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç.
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–∞.
- ‚úÖ –†–∞—Å—Å—ã–ª–∫–∞ –æ–ø—Ä–æ—Å–æ–≤ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –≥—Ä—É–ø–ø—ã –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
- ‚úÖ –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/poll_<id>`.
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ bot.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ Telegram-–±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–æ–∫–µ–Ω, –ë–î)
‚îú‚îÄ‚îÄ db.py                   # –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL
‚îÇ
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ admin.py            # –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤ (FSM)
‚îÇ   ‚îî‚îÄ‚îÄ respond.py          # –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ poll_manager.py     # –†–∞—Å—Å—ã–ª–∫–∞ –æ–ø—Ä–æ—Å–æ–≤ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —á–∞—Ç–∞ –≤ –õ–°
‚îÇ
‚îî‚îÄ‚îÄ README.md               # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```

2. –°–æ–∑–¥–∞–π –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ —Ç–∞–±–ª–∏—Ü—ã:

```sql
CREATE TABLE polls (
    id SERIAL PRIMARY KEY,
    title TEXT,
    description TEXT,
    creator_id BIGINT
);

CREATE TABLE questions (
    id SERIAL PRIMARY KEY,
    poll_id INTEGER REFERENCES polls(id),
    text TEXT,
    is_open BOOLEAN
);

CREATE TABLE options (
    id SERIAL PRIMARY KEY,
    question_id INTEGER REFERENCES questions(id),
    text TEXT
);

CREATE TABLE answers (
    id SERIAL PRIMARY KEY,
    user_id BIGINT,
    question_id INTEGER REFERENCES questions(id),
    text TEXT
);

CREATE TABLE users (
    id BIGINT PRIMARY KEY
);

CREATE TABLE chat_members (
    chat_id BIGINT,
    user_id BIGINT REFERENCES users(id),
    PRIMARY KEY (chat_id, user_id)
);
```

3. –£–∫–∞–∂–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `config.py`:

```python
BOT_TOKEN = "your_token_here"
DB_CONFIG = {
    "dbname": "db_name",
    "user": "db_user",
    "password": "db_pass",
    "host": "localhost",
    "port": 5432
}
```

4. –ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞:

```bash
python bot.py
```

---

## üìå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

- `/create_poll` ‚Äî –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–ø—Ä–æ—Å–∞ (FSM).
- `/poll_<id>` ‚Äî –ø—Ä–æ–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–ø—Ä–æ—Å (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –õ–°).

–î–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏:

```python
from services.poll_manager import send_poll_to_users
await send_poll_to_users(bot, chat_id=123456, poll_id=1)
```

---

## üîß –ü–ª–∞–Ω—ã –ø–æ –¥–æ—Ä–∞–±–æ—Ç–∫–µ

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω–æ–º –æ–ø—Ä–æ—Å–µ
- [ ] –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [ ] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ
- [ ] –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –Ω–∞ aiogram



---
---

# –ù–µ —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –≤—Å–µ, —á—Ç–æ –Ω–∏–∂–µ –µ—â–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ)

# ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤

    –ö–æ–º–∞–Ω–¥–∞ /create_poll –∑–∞–ø—É—Å–∫–∞–µ—Ç FSM-—Å—Ü–µ–Ω–∞—Ä–∏–π —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞.

    –ë–æ—Ç –ø–æ—à–∞–≥–æ–≤–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç:

        –ó–∞–≥–æ–ª–æ–≤–æ–∫

        –û–ø–∏—Å–∞–Ω–∏–µ

        –í–æ–ø—Ä–æ—Å (–æ–¥–∏–Ω –ø–æ–∫–∞)

        –¢–∏–ø –≤–æ–ø—Ä–æ—Å–∞ (–æ—Ç–∫—Ä—ã—Ç—ã–π –∏–ª–∏ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏)

        –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω—ã)

    –í—Å—ë —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤

    –û—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç.

    –ó–∞–∫—Ä—ã—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Äî –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–∏–Ω –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.

‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î

    –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:

        –û–ø—Ä–æ—Å—ã

        –í–æ–ø—Ä–æ—Å—ã

        –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤

    –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ psycopg2.

‚úÖ –†–∞—Å—Å—ã–ª–∫–∞ –æ–ø—Ä–æ—Å–æ–≤ –≤ –õ–°

    –í services/poll_manager.py —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è:

        –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —á–∞—Ç–∞ (—á–µ—Ä–µ–∑ chat_members)

        –ü—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∂–¥–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º –ø—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å

‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

    –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–æ–¥—É–ª–∏: handlers, services, db

    main.py –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã

    config.py —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–∫–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î

## ‚ùó–ß—Ç–æ –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–Ω–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –±—ã—Å—Ç—Ä–æ):

‚ùó–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–æ—Ç–≤–µ—Ç—ã)

‚ùó–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è

‚ùó–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

‚ùó–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω–æ–º –æ–ø—Ä–æ—Å–µ

‚ùó–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º

‚ùó–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ users –∏ chat_members –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –±–æ—Ç–∞ –≤ —á–∞—Ç


